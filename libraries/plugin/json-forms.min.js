!function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):"object"==typeof exports?exports.JSONForms=factory():root.JSONForms=factory()}(this,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module){"use strict";function isNumeric(value){return/^\d+$/.test(value)}function parsePath(path){var originalPath=path,steps=[],error=!1,firstKey=path.substr(0,path.indexOf("["));firstKey.length?(path=path.substr(path.indexOf("["),path.length),steps.push({key:firstKey,last:!path.length,type:"object"})):error=!0;var key;for(key=path.substr(1,path.indexOf("]")-1);path.length&&!error;)"["===path[0]&&"]"===path[1]?(steps.push({append:!0,type:"array"}),path=path.substr(2,path.length),error=0!==path.length):isNumeric(key=path.substr(1,path.indexOf("]")-1))?(key=parseInt(key,10),path=path.substr(path.indexOf("]")+1,path.length),steps.push({key:key,type:"array"})):(key=path.substr(1,path.indexOf("]")-1))&&-1===key.indexOf("[")?(path=path.substr(path.indexOf("]")+1,path.length),steps.push({key:key,type:"object"})):error=!0;if(error)steps=[{key:originalPath,last:!0,type:"object"}];else for(var i=0;i<steps.length;i++){var step=steps[i],nextStep=steps[i+1];nextStep?step.nextType=nextStep.type:step.last=!0}return steps}function setValue(context,step,currentValue,entryValue,isFile){if(isFile&&(entryValue={name:"filename",type:"filetype",body:"filebody"}),step.last){if("undefined"==typeof currentValue)step.append?context.push(entryValue):context[step.key]=entryValue;else if(currentValue.constructor==Array)context[step.key].push(entryValue);else{if(currentValue.constructor==Object&&!isFile)return setValue(currentValue,{key:"",last:!0,type:"object"},currentValue[""],entryValue,isFile);context[step.key]=[currentValue,entryValue]}return context}if("undefined"==typeof currentValue)return context[step.key]="array"===step.nextType?[]:{},context[step.key];if(currentValue.constructor===Object)return context[step.key];if(currentValue.constructor===Array){if("array"===step.nextType)return currentValue;var object={};return currentValue.forEach(function(item,i){"undefined"!=typeof item?object[i]=item:context[step.key]=object}),object}var object={"":currentValue};return context[step.key]=object,object}function JSONEncode(formEl){var entries=collectEntries(formEl),resultingObject={};return entries.forEach(function(entry){for(var isFile=entry.value&&void 0!==entry.value.body,steps=parsePath(entry.name),context=resultingObject,i=0;i<steps.length;i++){var step=steps[i],currentValue=context[step.key];context=setValue(context,step,currentValue,entry.value,isFile)}}),resultingObject}function collectEntries(formEl){return[].concat(Array.prototype.slice.call(formEl.querySelectorAll("input:not([type=submit])")).map(function(el){var entry={name:el.name,value:el.value};switch(el.type){case"checkbox":entry.value=el.checked;break;case"number":entry.value=parseInt(el.value,10);break;case"radio":if(!el.checked)return null;entry.value===el.value}return entry})).concat(Array.prototype.slice.call(formEl.querySelectorAll("select:not([multiple])")).map(function(el){return{name:el.name,value:el.value}})).concat(Array.prototype.slice.call(formEl.querySelectorAll("select[multiple] option[selected]")).map(function(el){var selectEl=parent(el,"select");return{name:selectEl.name,value:el.value}})).concat(Array.prototype.slice.call(formEl.querySelectorAll("textarea")).map(function(el){return{name:el.name,value:el.value}})).filter(function(entry){return entry})}function parent(el,tagName){for(tagName=tagName.toLowerCase();el&&el.parentNode;)if(el=el.parentNode,el.tagName&&el.tagName.toLowerCase()==tagName)return el;return null}function JSONFormSubmitHandler(e){var data,request,el=e.target;"FORM"===el.tagName&&"application/json"===el.getAttribute("enctype")&&(e.preventDefault(),data=JSON.stringify(JSONEncode(el)),request=new XMLHttpRequest,request.open("POST",el.action),request.setRequestHeader("Content-Type","application/json; charset=utf-8"),request.send(data),request.onload=function(){console.log(request.status>200&&request.status<400?"success :)":"failure :(")})}module.exports={enable:function(){addEventListener("submit",JSONFormSubmitHandler)},encode:JSONEncode,disable:function(){removeEventListener("submit",JSONFormSubmitHandler)}}}])});
//# sourceMappingURL=json-forms.min.map